tic
circle=[1 78.01076876424057 -29.770074482950406 191.09216388135587 519.3993336334916;
2 75.2516378341914 -41.13472434755559 114.08359098735491 470.64711763439453;
3 75.3499560781925 -113.0498583684658 87.82018125487102 456.1864528381532;
4 74.80004829005321 -170.85794111830626 84.55191371464682 456.75682319492546;
5 77.1070826867811 -57.70523137261688 32.531993470373365 413.2507238134209;
6 77.18376853309726 29.741628085662967 13.515513216661617 395.9647575527122;
7 76.10936852572883 79.71197770840858 -10.555675153626453 379.5953166980793;
8 76.68301938165763 41.2336281989959 -23.052338006074052 372.17067735590837;
9 76.1157981249327 -17.67071428134838 -25.92755985185552 372.97123177614344;
10 77.23895844936702 -51.92345312217534 76.74057362799175 443.5897454659339;
11 77.69545692645664 2.135853177434541 47.047503866937575 420.05674004813363;
12 76.01860310629955 -40.55628857383982 29.716273716787242 412.38932920607;
13 77.49851067569818 76.68647647753028 72.03320064730366 434.0400364212809;
14 76.75557477870818 118.2275035528871 47.43893703757331 416.60564865960185;
15 78.70004982930831 -131.81735469048206 71.6865548068412 441.2741333113692;
16 75.66722073057299 -103.75196367771485 162.9937069113393 507.8311624323569;
17 78.73405194870055 -39.33302329059528 179.63604196455637 511.38559311170457;
18 77.63397701519004 17.73594851113655 164.1836882616907 499.77242067067607;
19 77.89116063347961 18.719925281084123 154.85503240191377 513.3041819844395;
20 76.47470548191009 59.684113154776796 139.89285233931543 503.02041320111596;
21 78.69964237078607 58.04787973277497 89.92926090390172 465.93123039326554;
22 75.8548803993079 13.284546796373853 69.62226607485772 458.54939818145425;
23 76.35870687864096 -34.81924419746629 68.34144062074876 459.26782726139123;
24 75.31546052223138 -89.47289852816125 55.8157269265124 454.42758453271034;
25 77.16159411712164 -122.83472168611044 63.70180139473176 458.4991101166132;
26 75.08220750922723 -150.73981872088171 18.311268840746724 431.9300952870585;
27 75.96357596111868 -96.91235215584237 17.97201117471289 427.7037417562018;
28 78.90911608386094 -42.992962384380036 15.657594176023323 419.2286024907411;
29 77.22024177326024 15.087941857222404 12.788771000533927 417.6348718047296;
30 76.109939860608 46.34299554209623 2.307614473961138 410.4435110548285;];
% % 31 76.9524323280728 68.96568135426679 -28.9923866776559 386.68385623965173;
% % 32 76.02055050658997 -3.377782775662499 -52.808526285151856 374.74464363769437;
% % 33 75.69629016504308 -19.7472509816593 27.657759211384416 454.1333916252331;
% % 34 76.11197038523206 28.19923048177834 78.51020513988021 486.0072942088394;
% % 35 76.51940226586734 67.40591131591154 40.67522770540435 457.33493564450987;
% % 36 77.40763029244485 13.689079021220735 54.643080834743984 468.2647216850841;
% % 37 75.84740276800399 -20.900037900868497 52.166621575236576 471.0099994443867;
% % 38 78.21124246556555 -69.19229132107702 87.61125481919616 493.4222897125486;
% % 39 77.34819507742577 -116.60057710479765 66.75569717217232 482.3577542221263;
% % 40 76.2043578679543 -94.30790291379968 22.880977229215333 453.3074115437902;];

data=[500.450562 -367.751801 -94.763206 -267.301483;
411.52829 -373.482239 -93.421898 -261.247345;
382.95401 -459.184784 -94.118248 -274.202759;
382.650513 -510.295166 -94.117462 -268.744629;
311.843445 -399.898346 -92.897057 -269.422119;
285.212616 -299.759399 -91.703247 -256.223511;
256.921875 -257.518158 -91.703285 -262.339081;
242.487274 -303.239716 -91.959747 -269.54715;
241.746994 -359.605164 -91.959747 -267.626587;
364.167419 -395.544098 -93.525475 -271.229187;
326.033661 -338.988037 -92.833084 -267.900421;
309.532135 -383.292542 -92.833084 -269.504181;
353.228943 -255.759338 -92.626396 -259.033752;
323.320068 -214.067841 -92.303711 -257.970184;
358.241425 -479.560516 -94.081001 -276.46994;
472.034454 -456.703094 -95.604286 -281.575714;
484.446655 -384.851654 -95.027519 -274.702789;
466.034454 -319.91275 -94.200409 -265.880341;
466.041199 -319.911194 -110.920486 -265.879028;
448.719086 -272.793457 -110.374222 -259.478241;
385.42746 -276.630737 -109.782021 -260.960999;
367.570862 -331.525146 -110.136513 -270.621399;
366.095001 -386.849274 -110.630142 -278.175446;
354.889832 -440.117279 -110.630096 -277.284668;
362.840607 -472.884735 -110.881378 -277.66095;
310.558807 -507.966858 -110.876854 -283.764282;
308.645081 -449.087769 -110.260658 -278.452271;
299.94873 -386.337524 -109.487717 -269.961792;
297.089386 -328.820282 -109.30957 -269.325897;
284.955292 -291.165894 -108.792274 -262.995178;];
% % 245.658188 -271.057007 -108.410538 -264.543732;
% % 220.81546 -344.989166 -108.355186 -266.562714;
% % 330.511139 -372.777405 -128.433609 -277.550842;
% % 390.252716 -313.652893 -128.433609 -267.5224;
% % 342.194061 -266.232452 -127.454971 -259.014038;
% % 360.091797 -330.589203 -128.246002 -269.711578;
% % 359.37323 -375.690918 -128.851028 -279.540161;
% % 400.212341 -418.932343 -129.237213 -276.625183;
% % 378.697876 -468.801636 -129.360367 -279.259888;
% % 327.240387 -445.922089 -128.629776 -277.644592];

n=length(circle(:,1));
Ri=zeros(3,3,n);
ti=zeros(3,n);
ppi=zeros(3,n);
for i=1:n
    x=data(circle(i,1),1);
    y=data(circle(i,1),2);
    z=data(circle(i,1),3);
    sita=data(circle(i,1),4);
    Ri(:,:,i)=[cos(sita*pi/180),-sin(sita*pi/180),0;...
        sin(sita*pi/180),cos(sita*pi/180),0;...
        0,0,1];
    ti(:,i)=[x;y;z];
    ppi(:,i)=circle(i,3:5)';
end

% [R,tw,pw,rnti,k_num] = Alg(Ri,ti,ppi)
[R,tw,pw,thetap,rnti,k_num] = Alg(Ri,ti,ppi);
toc
